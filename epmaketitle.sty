\usepackage[absolute,overlay]{textpos}
\usepackage{ifthen}

% Range Parameter & Decoration
\newcommand{\titlecenterline}{0.25\paperheight}
\newcommand{\authorcenterline}{0.5\paperheight}
\newcommand{\studentidtopline}{0.55\paperheight}
\newcommand{\facultycenterline}{0.75\paperheight}
\newcommand{\datecenterline}{0.92\paperheight}
\newcommand{\epmktdeco}{$\ast\ast\ast\ast\ast$}

\textblockorigin{0mm}{0mm} % Origin of the textblock in the paper

\makeatletter

\def\title#1{\gdef\@title{#1}}
\def\author#1{\gdef\@author{#1}}
\def\date#1{\gdef\@date{#1}}
\def\titleEN#1{\gdef\@titleEN{#1}}				% Title (English)
\def\authorEN#1{\gdef\@authorEN{#1}} 		% Author (English)
\def\faculty#1{\gdef\@faculty{#1}}				% Faculty
\def\facultyEN#1{\gdef\@facultyEN{#1}}		% Faculty (English)
\def\advisor#1{\gdef\@advisor{#1}}				% Advisor
\def\studentid#1{\gdef\@studentid{#1}}  	% Student ID

% Initialization
\author{}
\title{}
\date{\today}
\titleEN{}
\authorEN{}
\faculty{}
\facultyEN{}
\advisor{}
\studentid{}


\newcommand{\epmaketitle}{
	\newpage\null
	\begin{center}%
		\let\footnote\thanks
		% Title parts (JPN/ENG)
		\begin{textblock*}{\linewidth}[0.5,0.5](0.5\paperwidth,\titlecenterline)%
			\ifx\@title\empty\else{%
				{\Huge \@title} \leavevmode\\[1mm]
			}\fi
			\ifx\@titleEN\empty\else{%
				{\Large \@titleEN}
			}\fi
		\end{textblock*}\par
		
		% Author Parts (JPN/ENG)
		\begin{textblock*}{\linewidth}[0.5,0.5](0.5\paperwidth,\authorcenterline)%
			\ifx\@author\empty\else{%
				{\huge \@author} \leavevmode\\[1mm]
			}\fi
			\ifx\@authorEN\empty\else{%
				{\LARGE \@authorEN}
			}\fi
		\end{textblock*}\par

		% Student ID Part
		\begin{textblock*}{\linewidth}[0.5,0.0](0.5\paperwidth,\studentidtopline)%
			\ifx\@studentid\empty\else{%
				{\LARGE 学籍番号：\@studentid}
			}\fi
		\end{textblock*}\par
		
		% Faculty & Advisor Parts
		\begin{textblock*}{0.8\linewidth}[0.5,0.5](0.5\paperwidth,\facultycenterline)%
			\newcount\paracntr
			\paracntr=0
			\ifx\@faculty\empty\else
				\advance\paracntr by 1
			\fi
			\ifx\@facultyEN\empty\else
				\advance\paracntr by 2
			\fi
			\ifx\@advisor\empty\else
				\advance\paracntr by 4
			\fi
			\ifx\@faculty\empty
				\ifx\@facultyEN\empty
					\def\facswitch\empty
				\fi
			\fi
			\ifnum\paracntr>4
				{\huge \epmktdeco}
				\vskip 0.01\paperheight
			\fi
			\ifx\@faculty\empty\else
				{\LARGE \@faculty}\leavevmode\\
			\fi
			\ifx\@facultyEN\empty\else
				{\LARGE \@facultyEN}
			\fi
			\ifx\facswitch\undefined
				\vskip 0.01\paperheight
			\fi
			\if\@advisor\empty\else
				{\LARGE 指導教員：\@advisor}
			\fi
			\ifnum\paracntr>4
				\vskip 0.01\paperheight
				{\huge \epmktdeco}
			\fi
		\end{textblock*}\par
		
		% Date Part
		\begin{textblock*}{0.6\linewidth}[0.5,1.0](0.5\paperwidth,\datecenterline)%
			{\LARGE \@date}%
		\end{textblock*}\par
	\end{center}%
}


\makeatother
